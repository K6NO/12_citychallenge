{"version":3,"sources":["app.module.js","app.config.js","navbar.module.js","auth.js","data.js","footer.directive.js","ChallengeController.js","ChallengesController.js","CurrentChallengeController.js","LoginController.js","LogoutController.js","NavbarController.js","ProfileController.js","SignupController.js"],"names":["cityChallengeApp","angular","module","run","$rootScope","$location","$route","authService","$on","event","next","getUserStatus","then","isLogin","isLoggedIn","savedLocation","url","path","console","log","config","$locationProvider","$routeProvider","$httpProvider","when","controller","controllerAs","templateUrl","otherwise","component","factory","$q","$timeout","$http","user","get","response","data","status","loggedInUser","getLoggedInUser","login","email","password","deferred","defer","post","emailAddress","resolve","reject","catch","promise","logout","register","service","this","getChallenges","successCallback","getChallenge","challengeId","addChallenge","challenge","errorCallback","updateChallenge","put","getCurrentChallenge","currentChallengeId","getCurrentChallengesForUser","addCurrentChallenge","currentChallenge","abandonCurrentChallenge","stepCompletedCurrentChallenge","steps","getUser","id","addUser","updateUser","getMessages","sendMessage","message","directive","restrict","replace","$scope","$filter","dataService","pageIdentifier","buttonFlag","split","userId","undefined","_id","currentChallenges","some","state","err","errors","startCurrentChallenge","description","stepNumber","challenges","pageIndicator","compare","a","b","createdAt","userMessages","messages","allMessages","partnerMessages","concat","sort","saveSteps","reload","newMessageText","currentChallengeMessages","removeError","error","push","isCollapsed","ranks","1","2","3","4","5","6","7","8","rank","level","selectedProfilePic","chooseProfilePic","clickedItem","profilePicUrl","target","attributes","src","value","photoUrl","fullName","userName"],"mappings":"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","file":"all.min.js","sourcesContent":["'use strict';\n\nvar cityChallengeApp = angular.module('cityChallengeApp', ['ngRoute', 'navbar']);\n\n// Verify logged in status on each restricted route every time when view changes\ncityChallengeApp.run([\"$rootScope\", \"$location\", \"$route\", \"authService\", function ($rootScope, $location, $route, authService) {\n    $rootScope.$on('$routeChangeStart', function (event, next) {\n        authService.getUserStatus().then(function () {\n            if (next.isLogin && !authService.isLoggedIn()) {\n                $rootScope.savedLocation = $location.url();\n                $location.path('/login');\n            } else {\n                console.log('logged in or login not required!');\n            }\n        });\n    });\n}]);","'use strict';\n\nangular.module('cityChallengeApp').config(['$locationProvider', '$routeProvider', '$httpProvider', function config($locationProvider, $routeProvider, $httpProvider) {\n\n    $routeProvider.when('/challenges/', {\n        controller: 'ChallengesController',\n        controllerAs: 'vm',\n        templateUrl: 'templates/challenge-list.template.html',\n        isLogin: false\n    }).when('/challenges/:challengeId', {\n        controller: 'ChallengeController',\n        controllerAs: 'vm',\n        templateUrl: 'templates/challenge-detail.template.html',\n        isLogin: true\n\n    }).when('/profile', {\n        controller: 'ProfileController',\n        controllerAs: 'vm',\n        templateUrl: 'templates/profile.template.html',\n        isLogin: true\n\n    }).when('/challenges/current/:currentChallengeId', {\n        controller: 'CurrentChallengeController',\n        controllerAs: 'vm',\n        templateUrl: 'templates/current-challenge.template.html',\n        isLogin: true\n\n    }).when('/login', {\n        controller: 'LoginController',\n        controllerAs: 'vm',\n        templateUrl: 'templates/login.template.html',\n        isLogin: false\n    }).when('/logout', {\n        controller: 'LogoutController',\n        controllerAs: 'vm',\n        isLogin: false\n    }).when('/signup', {\n        controller: 'SignupController',\n        controllerAs: 'vm',\n        templateUrl: 'templates/signup.template.html',\n        isLogin: false\n    }).otherwise('/challenges');\n}]);\n// All variables defined with the : prefix are extracted into the (injectable) $routeParams object.","'use strict';\n\nangular.module('navbar', []).component('navbar', {\n    templateUrl: 'templates/navbar.template.html',\n    controller: 'NavbarController'\n});","'use strict';\n\nangular.module('cityChallengeApp').factory('authService', ['$q', '$timeout', '$http', function ($q, $timeout, $http) {\n    var user = null;\n    var loggedInUser = null;\n\n    function isLoggedIn() {\n\n        if (user) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    function getUserStatus() {\n        return $http.get('/auth/loggedin').then(function (response) {\n            if (response.data.status === false) {\n                user = false;\n            } else {\n                user = true;\n                loggedInUser = response.data.user;\n            }\n        });\n    }\n\n    function getLoggedInUser() {\n        if (loggedInUser) {\n            return loggedInUser;\n        } else {\n            return false;\n        }\n    }\n\n    function login(email, password) {\n\n        // create a new instance of deferred\n        var deferred = $q.defer();\n\n        // send a post request to the server\n        $http.post('/auth/login', { emailAddress: email, password: password })\n        // handle success, set loggedInUser and user status\n        .then(function (response) {\n            if (response.status === 200) {\n                user = true;\n                loggedInUser = response.data;\n                deferred.resolve();\n            } else {\n                user = false;\n                deferred.reject();\n            }\n        })\n        // handle error\n        .catch(function (data) {\n            user = false;\n            deferred.reject(data);\n        });\n\n        // return promise object\n        return deferred.promise;\n    }\n\n    function logout() {\n\n        // create a new instance of deferred\n        var deferred = $q.defer();\n\n        // send a get request to the server\n        $http.get('/auth/logout')\n        // handle success, set user and loggedInUser to false\n        .then(function () {\n            user = false;\n            loggedInUser = null;\n            deferred.resolve();\n        })\n        // handle error\n        .catch(function () {\n            user = false;\n            deferred.reject();\n        });\n\n        // return promise object\n        return deferred.promise;\n    }\n\n    function register(user) {\n\n        // create a new instance of deferred\n        var deferred = $q.defer();\n\n        // send a post request to the server\n        $http.post('/auth/signup', user)\n        // handle success, set loggedInUser and user status\n        .then(function (response) {\n            if (response.status === 200 && response) {\n                loggedInUser = response.data;\n                deferred.resolve();\n            } else {\n                deferred.reject();\n            }\n        })\n        // handle error\n        .catch(function (data) {\n            deferred.reject(data);\n        });\n\n        // return promise object\n        return deferred.promise;\n    }\n\n    return {\n        isLoggedIn: isLoggedIn,\n        getUserStatus: getUserStatus,\n        login: login,\n        logout: logout,\n        register: register,\n        getLoggedInUser: getLoggedInUser\n    };\n}]);","'use strict';\n\n(function () {\n\n    'use strict';\n\n    angular.module('cityChallengeApp').service('dataService', [\"$http\", function ($http) {\n\n        // CHALLENGES\n\n        //GET /challenges - Gets all of the challenges.\n        this.getChallenges = function (successCallback) {\n            $http.get('/api/challenges').then(successCallback);\n        };\n\n        //GET /challenge/:id - Gets a challenge.\n        this.getChallenge = function (challengeId, successCallback) {\n            $http.get('/api/challenges/' + challengeId).then(successCallback);\n        };\n\n        // POST /challenges/ create a new challenge\n        this.addChallenge = function (challenge, successCallback, errorCallback) {\n            $http.post('/api/challenges', challenge).then(successCallback, errorCallback);\n        };\n\n        // PUT update a challenge (likes, difficulty, fun, times_taken) - TODO: change challenge object on front-end side\n        this.updateChallenge = function (challengeId, challenge, successCallback, errorCallback) {\n            $http.put('/api/challenges/' + challengeId, challenge).then(successCallback, errorCallback);\n        };\n\n        /* CURRENT CHALLENGES */\n\n        // GET a single currentChallenge\n        this.getCurrentChallenge = function (currentChallengeId, successCallback, errorCallback) {\n            $http.get('/api/current/challenges/' + currentChallengeId).then(successCallback, errorCallback);\n        };\n\n        // GET all currentChallenges for user\n        // returns an array of currentChallenges objects\n        this.getCurrentChallengesForUser = function (successCallback, errorCallback) {\n            $http.get('/api/current/user/challenges/').then(successCallback, errorCallback);\n        };\n\n        // POST create a new current challenge AND check for matching challenge\n        // returns currentChallenges = [firstChallenge, secondChallenge] IF matches were found OR just saved: true\n        this.addCurrentChallenge = function (currentChallenge, successCallback, errorCallback) {\n            $http.post('/api/current/challenges/', currentChallenge).then(successCallback, errorCallback);\n        };\n\n        // PUT update a current challenge - abandon\n        // returns updated currentChallenge\n        this.abandonCurrentChallenge = function (currentChallengeId, currentChallenge, successCallback, errorCallback) {\n            $http.put('/api/current/challenges/' + currentChallengeId + '/abandon', currentChallenge).then(successCallback, errorCallback);\n        };\n\n        // PUT update a current challenge - step completed\n        // returns updated currentChallenge\n        this.stepCompletedCurrentChallenge = function (currentChallengeId, steps, successCallback, errorCallback) {\n            $http.put('/api/current/challenges/' + currentChallengeId, steps).then(successCallback, errorCallback);\n        };\n\n        // USERS\n\n        // GET /user\n        this.getUser = function (id, successCallback) {\n            $http.get('/api/users/' + id).then(successCallback);\n        };\n\n        // POST - create a single user\n        this.addUser = function (user, successCallback, errorCallback) {\n            $http.post('/api/users', user).then(successCallback, errorCallback);\n        };\n\n        // PUT - update a single user\n        this.updateUser = function (id, user, successCallback, errorCallback) {\n            $http.put('/api/users/' + id, user).then(successCallback, errorCallback);\n        };\n\n        // MESSAGES\n\n        // GET messages for currentChallenge\n        // returns an array of messages\n        this.getMessages = function (currentChallengeId, successCallback) {\n            $http.get('/api/current/challenges/' + currentChallengeId + '/messages').then(successCallback);\n        };\n\n        // POST new text for currentChallenge\n        // returns an array of updated messages\n        this.sendMessage = function (currentChallengeId, message, successCallback, errorCallback) {\n            $http.post('/api/current/challenges/' + currentChallengeId + '/messages', message).then(successCallback, errorCallback);\n        };\n    }]);\n})();","'use strict';\n\ncityChallengeApp.directive('footerElement', function () {\n     return {\n          templateUrl: 'templates/footer.template.html',\n          restrict: 'E',\n          replace: true\n     };\n});","'use strict';\n\n(function () {\n    'use strict';\n\n    angular.module('cityChallengeApp').controller('ChallengeController', ['$scope', '$location', '$filter', 'dataService', 'authService', function ($scope, $location, $filter, dataService, authService) {\n\n        $scope.pageIdentifier = 'landing-page';\n        $scope.buttonFlag = '';\n\n        var challengeId = $location.path().split('/')[2];\n        var userId = undefined;\n        console.log(challengeId);\n\n        if (challengeId != undefined) {\n            //get challenge and matching currentChallenges\n            dataService.getChallenge(challengeId, function (response) {\n                // get user\n                var user = authService.getLoggedInUser();\n                $scope.user = user;\n                userId = user._id;\n                $scope.challenge = response.data.challenge;\n\n                // check status of matching currentChallenges\n\n                response.data.currentChallenges.some(function (currentChallenge) {\n                    console.log('in some');\n                    if (currentChallenge.state === 'active' || currentChallenge.state === 'waiting') {\n                        $scope.currentChallengeId = currentChallenge._id;\n                        $scope.buttonFlag = 'active';\n                        console.log('active');\n\n                        return;\n                    } else if (currentChallenge.state === 'completed') {\n                        $scope.currentChallengeId = currentChallenge._id;\n                        $scope.buttonFlag = 'completed';\n                        console.log('completed');\n                        return;\n                    } else {\n                        $scope.currentChallengeId = currentChallenge._id;\n                        $scope.buttonFlag = 'failed';\n                        console.log('failed');\n                        return;\n                    }\n                });\n            }, function (err) {\n                $scope.errors = err;\n            });\n        }\n\n        $scope.startCurrentChallenge = function () {\n            var currentChallenge = {\n                \"user\": userId,\n                \"challenge\": challengeId,\n                \"steps\": [{\n                    \"description\": $scope.challenge.steps[0].description,\n                    \"stepNumber\": $scope.challenge.steps[0].stepNumber\n                }, {\n                    \"description\": $scope.challenge.steps[1].description,\n                    \"stepNumber\": $scope.challenge.steps[1].stepNumber\n                }, {\n                    \"description\": $scope.challenge.steps[2].description,\n                    \"stepNumber\": $scope.challenge.steps[2].stepNumber\n                }]\n            };\n            dataService.addCurrentChallenge(currentChallenge, function (response) {\n                console.log(response);\n                $scope.currentChallenge = response.data.currentChallenge;\n                $location.path(\"/challenges/current/\" + response.data.currentChallenge._id);\n            }, function (response) {\n                $scope.errors = response.data.errors;\n            });\n        };\n    }]);\n})();","'use strict';\n\n(function () {\n    'use strict';\n\n    angular.module('cityChallengeApp').controller('ChallengesController', ['$scope', '$location', '$filter', 'dataService', function ($scope, $location, $filter, dataService) {\n\n        // get all challenges\n        dataService.getChallenges(function (response) {\n            $scope.challenges = response.data;\n        });\n\n        $scope.pageIndicator = 'landing-page';\n    }]);\n})();","'use strict';\n\n(function () {\n    'use strict';\n\n    angular.module('cityChallengeApp').controller('CurrentChallengeController', ['$scope', '$location', '$route', '$filter', 'dataService', 'authService', function ($scope, $location, $route, $filter, dataService, authService) {\n\n        var errorCallback = function errorCallback(response) {\n            $scope.errors = response.data;\n        };\n\n        $scope.pageIdentifier = 'landing-page';\n        $scope.message = {};\n\n        var user = authService.getLoggedInUser();\n        //$scope.user = user;\n        console.log(user._id);\n\n        var currentChallengeId = $location.path().split('/')[3];\n\n        if (currentChallengeId != undefined) {\n            //get challenge\n            dataService.getCurrentChallenge(currentChallengeId, function (response) {\n\n                // helper function to sort messages by date\n                function compare(a, b) {\n                    if (a.createdAt < b.createdAt) return -1;\n                    if (a.createdAt > b.createdAt) return 1;\n                    return 0;\n                }\n                if (response.data.currentChallenge.user._id !== user._id) {\n                    // TODO create error page and show it to the user\n                    $scope.errors = 'It is not your challenge, so you cannot see it.';\n                } else {\n                    var userMessages = response.data.currentChallenge.messages;\n                    var allMessages = [];\n                    if (response.data.partnerMessages) {\n                        var partnerMessages = response.data.partnerMessages;\n                        allMessages = userMessages.concat(partnerMessages);\n                        $scope.partnerMessages = response.data.partnerMessages;\n                    } else {\n                        allMessages = userMessages;\n                    }\n\n                    allMessages.sort(compare);\n\n                    $scope.currentChallenge = response.data.currentChallenge;\n                    if (allMessages) {\n                        $scope.messages = allMessages;\n                    }\n\n                    // bind checkboxes to steps\n                    //$scope.steps = response.data.currentChallenge.steps;\n                }\n            }, errorCallback);\n        }\n\n        $scope.saveSteps = function () {\n\n            dataService.stepCompletedCurrentChallenge($scope.currentChallenge._id, $scope.currentChallenge.steps, function (response) {\n                $route.reload();\n            }, errorCallback);\n        };\n\n        $scope.abandonCurrentChallenge = function () {\n            var currentChallenge = {\n                \"state\": 'abandoned'\n            };\n            dataService.abandonCurrentChallenge(currentChallengeId, currentChallenge, function (currentChallenge) {\n                $scope.currentChallenge = currentChallenge;\n                console.log($scope.currentChallenge);\n                $location.path(\"/challenges\");\n            }, errorCallback);\n        };\n\n        $scope.sendMessage = function (newMessageText) {\n            console.log(newMessageText);\n            dataService.sendMessage($scope.currentChallenge._id, { \"message\": newMessageText }, function (currentChallengeMessages) {\n                $scope.currentChallenge.messages = currentChallengeMessages.data;\n                $scope.newMessageText = '';\n                $route.reload();\n            }, errorCallback);\n        };\n    }]);\n})();","'use strict';\n\n(function () {\n    'use strict';\n\n    angular.module('cityChallengeApp').controller('LoginController', ['$scope', '$location', 'dataService', 'authService', function ($scope, $location, dataService, authService) {\n\n        $scope.pageIdentifier = 'signup-page';\n        $scope.user = {};\n        $scope.errors = [];\n\n        $scope.removeError = function () {\n            $scope.errors = [];\n        };\n\n        $scope.login = function () {\n            //$scope.error = false;\n            //$scope.disabled = true;\n\n            authService.login($scope.user.emailAddress, $scope.user.password).then(function () {\n                $location.path('/profile');\n                //$scope.disabled = false;\n                //$scope.loginForm= {};\n            }).catch(function (error) {\n                if (error.status === 401) {\n                    $scope.errors.push('Email already registered or wrong password.');\n                    $scope.user.password = '';\n                } else {\n                    $scope.errors.push(error.data);\n                    $scope.user.password = '';\n                }\n            });\n        };\n    }]);\n})();","'use strict';\n\n(function () {\n    'use strict';\n\n    angular.module('cityChallengeApp').controller('LogoutController', ['$scope', '$location', 'dataService', 'authService', function ($scope, $location, dataService, authService) {\n\n        $scope.pageIdentifier = 'signup-page';\n        $scope.user = {};\n\n        $scope.logout = function () {\n\n            authService.logout().then(function () {\n                $location.path('/challenges');\n            }).catch(function () {\n                $scope.errors = 'Cannot logout';\n            });\n        };\n    }]);\n})();","'use strict';\n\nangular.module('navbar').controller('NavbarController', ['$scope', 'authService', function ($scope, authService) {\n    $scope.isCollapsed = true;\n    var user = authService.getLoggedInUser();\n    $scope.user = user;\n}]);","'use strict';\n\n(function () {\n    'use strict';\n\n    angular.module('cityChallengeApp').controller('ProfileController', ['$scope', '$location', '$filter', 'dataService', 'authService', function ($scope, $location, $filter, dataService, authService) {\n\n        //console.log('in user controller');\n        //console.log(user);\n        $scope.pageIndicator = 'profile-page';\n\n        var user = authService.getLoggedInUser();\n        $scope.user = user;\n        console.log(user._id);\n\n        dataService.getCurrentChallengesForUser(function (response) {\n            $scope.currentChallenges = response.data;\n        }, function (response) {\n            $scope.errors = response.data.errors;\n        });\n\n        var ranks = {\n            1: 'Initiate',\n            2: 'Waking Consciousness',\n            3: 'Deep Dreaming',\n            4: 'Inner Silence',\n            5: 'Awakening',\n            6: 'Eternal Sunshine',\n            7: 'Mindful Inner Peace',\n            8: 'Spirit Being'\n        };\n\n        $scope.rank = ranks[user.level];\n    }]);\n})();","'use strict';\n\n(function () {\n    'use strict';\n\n    angular.module('cityChallengeApp').controller('SignupController', ['$scope', '$location', '$filter', 'dataService', 'authService', function ($scope, $location, $filter, dataService, authService) {\n\n        $scope.errors = [];\n        $scope.pageIdentifier = 'signup-page';\n        $scope.user = {};\n        $scope.selectedProfilePic = 0;\n\n        $scope.chooseProfilePic = function (clickedItem) {\n            var profilePicUrl = clickedItem.target.attributes.src.value;\n            $scope.selectedProfilePic = clickedItem.target.attributes.id.value;\n            $scope.user.photoUrl = profilePicUrl;\n        };\n\n        $scope.removeError = function () {\n            $scope.errors = [];\n        };\n\n        // get all challenges\n        $scope.register = function (user) {\n            if (user.fullName && user.userName && user.emailAddress && user.password && user.photoUrl) {\n                authService.register(user).then(function (response) {\n                    console.log(response);\n                    $location.path('/profile');\n                }).catch(function (error) {\n                    $scope.user.password = '';\n                    $scope.errors.push(error.data);\n                });\n            } else {\n                $scope.user.password = '';\n                $scope.errors.push('Fill in all fields and choose a profile pic.');\n            }\n        };\n    }]);\n})();"]}